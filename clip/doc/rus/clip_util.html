<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<LINK REL=STYLESHEET TYPE="text/css" HREF="styl.css">
<TITLE>Clipper compiler</TITLE>
</HEAD>
<BODY>

<h4>           Полезные утилиты</h4>
<HR>
		 <a href="clip.html"> CLIP - компилятор и сборщик программ </a>

<HR>
		  <a href="debug.html"> clip_dbg,clip_cld - отладчики </a>

<HR>
<HR>
	  clip_hindex,clip_hseek - hyper text/HTML индексация и поиск.

<HR>
<h3>           CLIP_WE - многооконный текстовый редактор </h3>

Текстовый редактор с приличными возможностями, базирующийся на классах
<a href="o_medit.html"> textedit, medit </a>

<HR>
<h3>           CLIP_BLANK - интерпретатор шаблонов документов</h3>
Шаблон документа представляет из себя текст со встроеными в него
clipper-выражениями. Например кусок платежки (жаль что бравзеры неправильно
показывают псевдографику):<BR>
<xmp>
**********************************************************
pen:=strsumma(platdoc->SUMMA)
pen1:=""
pen2:=""
#IF len(pen)>65
	  pen:=alltrim(pen)
	  s:=substr(pen,1,65)
	  s:=substr(s,1,rat(' ',s))
	  pen1:=substr(pen,len(s)+1)
	  pen:=s
#ENDIF
*************************************
nnn:=padr(alltrim(str(platdoc->no_pp,4,0)),4)
telegr:=1
aaa:=readkeyb(,,"1-почтой, 2-телеграфом, 3-электронно",@telegr)
telegr:=iif(telegr==2,"телеграфом",iif(telegr==3,"электронно","почтой"))
telegr:=padc(telegr,10)
d:=strtran(dtoc(platdoc->DAT),"/",".")
ssum:=strtran(alltrim(str(platdoc->summa)),".","-")

  ПЛАТЕЖНОЕ ПОРУЧЕНИЕ N #nnn   #d      #telegr
				   _____________  _____________
				  (Дата)      (Вид платежа)
Сумма   |#pen
прописью|
	|#pen1
--------┴------------------------------+-----+-------------------------
					   |     |
ИНН #padr(my_ident,12) #padr(substr(my_firma,1,22),22)|     |
..............
Ну и так далее.......
</xmp>
Как видно из этого примера: <BR>
- поддерживаются #if, #endif, #while #endwhile, #return <BR>
- строки содержание ":=" выполняются <BR>
- #var - подставляются в текст в виде вычисленного значения <BR>
<BR>
Вот собственно и все правила составления шаблонов. <BR>
Два ограничение - команды не поддерживаются и нельзя описать
свою функцию, зато поддерживаются ВСЕ clipper-функции.
<BR>
Смотрите таже функцию run_blank() для использования шаблонов без clip_blank.
<HR>


<h3>           CLIP_RUN - исполнитель po-файлов</h3>
PO-файлы - это файл с байт-кодом виртуальной машины CLIP. Можно сказать
что это кодовый блок, записанный в файл. Чтобы его получить надо использовать
ключик -p компилятора. <BR>
Все нижеописанное можно подсмотреть в utils/Makefile

<h4> Как сделать исполняемый po-файл</h4>
Напишите test.prg: <BR>
clear screen<BR>
use test    <BR>
browse()    <BR>
Скомпилируйте: <BR>
clip -p test.prg<BR>
Получится файл test.po размером байт эдак в 300-400<BR>
Теперь надо немного пошаманить над этим файлом, чтобы он стал исполняемым.<BR>
mv test.po test.po.0<BR>
cat "#!/путь_где_лежит_clip_run/clip_run" >test.po<BR>
(это такая шаманская строчка, которая как раз и заставляет систему
исполнять po-файл посредством clip_run и она должна быть самой первой в файле)<BR>
cat test.po.0 >>test.po<BR>
chmod +x test.po<BR>
Теперь выполняйте "test.po <enteer>" <BR>
Ну и как  ???? Понравилось ???
Файл размером всего в 300 байт, а сколько умеет ????
<hr>

<h3>           CLIP_PRG - исполнитель prg-файлов</h3>
"clip_prg filename.prg param1 param2 ...." - компилирует на лету prg-файл
и исполняет скомпилированный po-файл. <BR>
Чтобы получить исполняемый prg-файл, надо в первой строке написать:<BR>
#!/path_for_clip_exec_files/clip_prg <BR>
и поставить аттрибут исполняемости  prg-файлу командой <BR>
(chmod +x filename.prg) <BR>

<h3>           CLIP_BL  </h3>
Этот полезный интерпретатор ppo-файлов предоставлен <a href="http://unatlib.uni.udm.ru/~asg/">Сергеем Алешиным</a>.
Полное описание можно прочитать на его домашней страничке или <a href="asg.html"> здесь </a>.
<hr>


<h3>           WWW_CLIP </h3>
Это штука делает то же что <b>www-sql</b> от James Henstridge плюс кое-что еще.
Про <b>www-sql</b> читайте <a href=www_sql.html>здесь</a> или в
<a href=http://www.daa.com.au/~james/www-sql/www-sql.html>первоисточнике</a>.
Опишем здесь лишь особенности WWW_CLIP и его отличия от <b>www-sql</b>.<br>
1. Имена переменных нечувствительны к регистру.<br>
2. Вместо команды SETEXPR можно юзать просто SET - они полностью идентичны.<br>
3. Изменен синтаксис команды CONNECT. Самым первым параметром следует указывать
двухбуквенную строку идентифицирующую тип сервера базы данных -
"PG" - для PostgreSQL, "MS" - для MySQL, "OR" - для Oracle. Об использовании
SQL в Clip`е читайте <a href=dbfsql.html>здесь</a>. В случае Oracle
параметр <b>host</b> задает не имя хоста сервера, а т.н. connect string -
имя базы данных. Если хочется использовать базу данных по умолчанию или
локальный хост, но в то же время хочется задать логин и пароль, вместо параметра
<b>host</b> пишите <b>NIL</b>. Например, чтобы подключиться к умалчиваемой базе
данных Oracle под именем <b>scott</b> с паролем <b>tiger</b> тег должен иметь
следующий вид:<br>
<b>&lt;! sql connect OR NIL scott tiger&gt;</b><br>
4. В командах SET/SETEXPR/SETDEFAULT/EVAL можно использовать любые прилинкованные
функции Клиппер.<br>
<hr>


<h3>           WCL2PRG </h3>
WWW_CLIP, несомненно, полезная утилита, но если принять во внимание, что она
является не самым быстрым интерпретатором, становится очевидным,
что нужна еще утилита типа WCL2PRG. WCL2PRG на входе получает файл .WCL
(.HTML с тегами www-sql), а на выходе - исходник .PRG после компиляции которого
получается бинарник, выводящий в stdout то же самое что вывел бы WWW_CLIP, т.е.
полноценное cgi-bin приложение. В результате скорость возрастает многократно.<br>
Кроме того, использование WCL2PRG позволяет вставлять в .WCL клиппер-код.
Клиппер-код следует включать в тег-комментарий, начинающийся со слов "CLIP" или
"CLIPFUNC".<br>
Например:<br>
<b><pre>&lt;!-- clip QOUT("&lt;b&gt;Hello, world!&lt;/b&gt;") --&gt;</pre></b>
В результате работы полученного cgi-bin приложения клиент увидит в своем браузере
кроме прочего строку "Hello, world!" написанную жирным шрифтом.<br>
Команда CLIPFUNC предназначена для включения в конец генерируемого .PRG кода
многократно используемой функции или процедуры.<br>
Например:<br>
<b><pre>&lt;!-- clipfunc
PROCEDURE PrintPrices
	USE prices.dbf NEW ALIAS prices
	? "&lt;table border&gt;"
	? "&lt;tr&gt;&lt;th&gt;Наименование&lt;/th&gt;&lt;th&gt;Цена&lt;/th&gt;&lt;/tr&gt;"
	DO WHILE !prices->EOF()
		? "&lt;tr&gt;&lt;td&gt;",prices->Name,"&lt;/td&gt;&lt;td&gt;",prices->Price,"&lt;/td&gt;&lt;/tr&gt;"
		prices->SKIP()
	ENDDO
	? "&lt;/table&gt;"
RETURN
--&gt;</pre></b>
В результате клиент увидит в своем браузере таблицу с данными из <b>prices.dbf</b>
<br>
В встраиваемом клиппер-коде можно использовать переменные www-sql. Все они
хранятся в ассоциативном массиве <b>vars</b>. Например:<br>
<b><pre>&lt;! sql set quad 25 &gt;
&lt;! sql print $quad &gt;
&lt;!-- clip QOUT(SQRT(vars:quad)) --&gt;</pre></b>
<hr>


<h3>           SQLRUN </h3>
Эта утилита выполняет скрипты на языке SQL.
<hr>


<h3>           lowname </h3>
переводит имена файлов в нижний регистр<BR>
Использовать можно примерно так :<BR>
lowname *.PRG<BR>
<hr>

<h3>           clip_trans </h3>
<xmp>
clip_trans <source_codepage> <target_codepage> <file1>....<fileN>
</xmp>
Перекодирует файлы из любой кодировки в любую другую, например: <BR>
clip_trans cp866 cp1251 *.prg <BR>
перекодирует все prg-файлы из русской DOS кодировки в русскую Win кодировку.
<BR>
<hr>


<h3>           configure </h3>
Генерирует  clipcfg.h с описанием некоторых системно-зависимых констант и define,
используемый в clip.h.
Вообщем вам это не должно быть интересно.
<hr>


<h3>          clip_makeslib </h3>
Из нескольких обычных библиотек с расширением .a делает одну динамически
подключаемую библиотеку с расширением .so: этой утилитой создается libclip.so.
Можете ее использовать чтоб создавать свои загружаемый библиотеки.
<hr>


<h3>          clip_hindex, clip_hseek </h3>
Мини-google.
clip_hindex индексирует содержимое сайта. Полученный индекс затем используется
для быстрого поиска при помощи утилиты clip_hseek. Использована технология
HiPER-Seek.
<hr>
<center>&#169 Ю.Хныкин, <A HREF="mailto:uri@itk.ru">uri@itk.ru</A>, 2000
</center>
</body>
</html>
