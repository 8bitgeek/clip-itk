<HTML>
<HEAD><TITLE>COM_HARD</TITLE></HEAD>
<BODY>

<PRE>
 <B>COM_HARD()</B>
 Turns the hardware handshake (automatic CTS) on/off
<HR>
 <B>Syntax</B>

     <B>COM_HARD(&lt;nComPort&gt;,&lt;lNewHandshake&gt;,[&lt;lDTR/DSR&gt;])</B>
     <B>   --&gt; lOldHandshake</B>

 <B>Arguments</B>

     <B>&lt;nComPort&gt;</B>  Designates the port (1 to N) for which the hardware
     handshake is switched on or off.

     <B>&lt;lNewHandshake&gt;</B>  Designates whether the handshake is on (.T.) or off
     (.F.).

     <B>&lt;lDTR/DSR&gt;</B>  Designates whether the function uses the DTR/DSR
     handshake or the RTS/CTS handshake.  When passed as .T., the function
     uses the DTR/DSR handshake instead of the RTS/CTS handshake.

 <B>Returns</B>

     When called only with &lt;nComPort&gt;, the COM_HARD() returns .T. if the
     hardware handshake is on and .F.  if the hardware handshake is off.
     When &lt;lNewHandshake&gt; is passed, the function returns the status prior to
     the new setting.

 <B>Description</B>

     The size of a receiving buffer is always limited.  To avoid overflow,
     and thereby a loss of characters, software or hardware handshakes are
     usually implemented.  During a hardware handshake, the port monitors the
     RTS signal.  If you use this function to switch this handshake on, the
     signal is activated as soon as the buffer is 75% full.  As soon as the
     buffer content is once again reduced to 50% or less, the port (the RTS
     signal) is once again released.  Some printers use the port signals, DTR
     (output like RTS) and DSR (entry like CTS) instead of RTS/CTS, to avoid
     buffer overflow.  In this case, &lt;lDTR/DSR&gt; can be passed with .T..

 <B>Notes</B>

     <B>”</B>  The hardware handshake only supports background transmission
        (when COM_OPEN() is implemented with the third parameter
        &lt;nBufferOut&gt;).

     <B>”</B>  This function works for data input as well as output.

     <B>”</B>  If you use a hardware handshake, then the RTS signal should no
        longer be affected by COM_RTS() or COM_MCR().

 <B>Example</B>

     Turn on the hardware handshake at a port:

     COM_OPEN(2, 1000, 1000)          // Open COM2, background send
                                      // buffer
     COM_HARD(2, .T.)                 // RTS/CTS Hardware handshake
                                      // for port 2

</PRE>
<HR>
<B>See Also:</B>
<A HREF="com_read.html">COM_READ()</A>
<A HREF="com_send.html">COM_SEND()</A>
<A HREF="com_soft.html">COM_SOFT()</A>
<HR>
</BODY>
</HTML>
